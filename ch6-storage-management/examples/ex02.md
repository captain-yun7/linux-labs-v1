### ex02 : 새 디스크 파티션 나누기

# 경고: 이 예제는 디스크의 파티션 테이블을 직접 수정합니다.
# 실제 운영 서버의 디스크에 잘못 사용하면 모든 데이터가 영구적으로
# 삭제될 수 있습니다. 반드시 아래의 가상 디스크 환경에서만 실습하세요.

#### 1. 실습용 가상 디스크 준비

```bash
# [1GB 크기의 가상 디스크 파일 만들기]
# fallocate 명령어로 'vdisk.img'라는 이름의 1GB 파일을 즉시 생성합니다.
fallocate -l 1G vdisk.img

# [가상 디스크를 시스템에 연결하기]
# losetup 명령어로 파일을 루프백 디바이스(/dev/loop10)에 연결합니다.
# 이제 시스템은 이 파일을 실제 디스크처럼 인식합니다.
sudo losetup /dev/loop10 vdisk.img

# [연결 확인하기]
# lsblk로 /dev/loop10 디바이스가 보이는지 확인합니다.
lsblk
```

#### 2. fdisk로 파티션 작업하기

```bash
# [fdisk 대화형 모드 시작]
# fdisk [디스크 장치] 명령으로 파티션 작업을 시작합니다.
sudo fdisk /dev/loop10
```

**fdisk 대화형 모드에서 사용하는 주요 명령어:**

*   `m` : 도움말 보기 (사용 가능한 모든 명령어 목록)
*   `p` : 현재 파티션 테이블 정보 출력
*   `n` : 새 파티션 추가
*   `d` : 파티션 삭제
*   `t` : 파티션 타입 변경
*   `w` : **변경 사항을 디스크에 저장하고 종료 (가장 중요)**
*   `q` : 변경 사항을 저장하지 않고 종료

**실습 시나리오: 500MB 크기의 주 파티션 생성하기**

1.  `fdisk` 프롬프트에서 `n`을 입력 (새 파티션)
2.  `p`를 입력 (주 파티션)
3.  `1`을 입력 (파티션 번호)
4.  첫 섹터에서 `Enter`키를 눌러 기본값 사용
5.  마지막 섹터에서 `+500M`을 입력하여 크기 지정
6.  `p`를 입력하여 파티션이 잘 만들어졌는지 확인
7.  `w`를 입력하여 변경 사항을 저장하고 종료

```bash
# [파티션 생성 결과 확인]
# fdisk 작업 완료 후, lsblk를 다시 실행하면
# /dev/loop10 아래에 /dev/loop10p1 이라는 새 파티션이 보입니다.
lsblk /dev/loop10
```

#### 3. 실습 마무리

```bash
# [가상 디스크 연결 해제]
sudo losetup -d /dev/loop10

# [가상 디스크 파일 삭제]
rm vdisk.img
``` 